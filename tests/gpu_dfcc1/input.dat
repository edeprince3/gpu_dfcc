#! cc-pvdz (H2O)2 Test DF-CCSD vs GPU-DF-CCSD

sys.path.insert(0,'../../../.')

import gpu_dfcc

molecule {
           O          0.000000000000     0.000000000000    -0.068516219310   
           H          0.000000000000    -0.790689573744     0.543701060724   
           H          0.000000000000     0.790689573744     0.543701060724   
           O          5.000000000000     0.000000000000    -0.068516219310   
           H          5.000000000000    -0.790689573744     0.543701060724   
           H          5.000000000000     0.790689573744     0.543701060724   
}

memory 32000 mb
set {
  cc_timings true
  num_gpus 1
  cc_type df
  df_basis_cc aug-cc-pvdz-ri
  df_basis_scf aug-cc-pvdz-jkfit
  basis        aug-cc-pvdz
  freeze_core true
  e_convergence 1e-8
  d_convergence 1e-8
  r_convergence 1e-8
  scf_type df
  maxiter 30
}

en = energy('gpu-df-ccsd')

ref_energy = -152.532253156213 # TEST
#compare_values(ref_energy, get_variable("CURRENT ENERGY"), 8, "CCSD total energy") # TEST
compare_values(ref_energy, en, 8, "CCSD total energy") # TEST


